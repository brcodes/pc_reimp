Experiment log begin: log/exp_241015_151330.txt
exp_name: architecture tests Li
notes: architecture tests
train_with: True
evaluate_with: False
predict_with: False
input_shape: (16, 864)
num_tiles: 16
num_layers: 3
hidden_lyr_sizes: [32, 128]
output_lyr_size: 212
architecture: expand_first_lyr
classif_method: c1
priors: Li_priors
lr_denominators: Li_denominators
update_method: {'rW_niters': 30}
softmax_type: normal
softmax_k: 1
model_type: static
tiled_input: True
flat_input: True
activ_func: linear
num_imgs: 212
num_classes: 212
dataset_train: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
epoch_n: 300
kr: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
alph: {1: 1.0, 2: 0.05, 3: 0.05}
lam: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
ssq: {0: 1, 1: 10, 2: 10, 3: 2}
plot_train: True
save_checkpoint: {'save_every': 5}
load_checkpoint: None
batch_size: 1



shapes
r0 shape: (16, 864)
r1 shape: (16, 32)
U1 shape: (16, 864, 32)
r2 shape: (128,)
U2 shape: (16, 32, 128)
r3 shape: (212,)
U3 shape: (128, 212)


priors: Li_priors init preview:
r0 first 3: [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
r1 first 3: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0.]]
U1 first 3x3x3: [[[-0.46910458 -0.11971244 -0.13104445]
  [-0.01692926 -0.21812114 -0.47230772]
  [ 0.07373831 -0.47213043  0.10118416]]

 [[ 0.26786216 -0.19967214 -0.01340202]
  [-0.41838352  0.42044475 -0.2646077 ]
  [-0.21889844 -0.19669298 -0.2037373 ]]

 [[ 0.01936846  0.31022557 -0.19559728]
  [ 0.00251656  0.09783645  0.27423799]
  [-0.41513198  0.087488    0.424993  ]]]
r2 first 3: [0. 0. 0.]
U2 first 3x3x3: [[[-0.49124224 -0.13727411  0.22879704]
  [ 0.23802216 -0.28446383  0.35092259]
  [-0.37814795  0.39202971  0.35333291]]

 [[ 0.39571711  0.24732939  0.14707372]
  [ 0.35177013  0.29795299 -0.03189295]
  [ 0.37411799  0.30413529  0.41575994]]

 [[-0.49740798  0.35025196  0.03157473]
  [ 0.2355319   0.31296476  0.38937223]
  [-0.19068088 -0.31686656 -0.1592648 ]]]
r3 first 3: [0. 0. 0.]
U3 first 3x3: [[-0.29798263 -0.13472081  0.10697085]
 [-0.46006267 -0.05899443  0.19599927]
 [-0.41240151  0.48396719  0.31004051]]


original X shape: (3392, 864)
test: reshaping X into num imgs, num tiles per image, flattened tile
Train init:
X shape: (212, 16, 864)
Y shape: (212, 212)
Checkpoint method: {'save_every': 5} 
 saving every 5


Epoch: 0
Jr: 33432382.431307204, Jc: 1133.1921653174659, Accuracy: 0.06132075471698113
Training...
Epoch 1
eval 1
Jr: 430401.2516585911, Jc: 1133.5325661708478, Accuracy: 0.0047169811320754715
Epoch time: 0:01:03.389886.
Est. time remaining: 5:15:53.575914.
Est. tot time: 5:16:56.965800.
Epoch 2
