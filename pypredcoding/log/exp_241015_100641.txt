exp_name: architecture tests
notes: architecture tests
train_with: True
evaluate_with: False
predict_with: False
input_shape: (16, 864)
num_tiles: 16
num_layers: 3
hidden_lyr_sizes: [32, 128]
output_lyr_size: 212
architecture: expand_first_lyr_Li
classif_method: c1
priors: Li_priors
lr_denominators: Li_denominators
update_method: {'rW_niters': 30}
softmax_type: normal
softmax_k: 1
model_type: static
tiled_input: True
flat_input: True
activ_func: linear
num_imgs: 212
num_classes: 212
dataset_train: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
epoch_n: 1
kr: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
alph: {1: 1.0, 2: 0.05, 3: 0.05}
lam: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
ssq: {0: 1, 1: 10, 2: 10, 3: 2}
plot_train: True
batch_size: 1
save_checkpoint: {'save_every': 50}
load_checkpoint: None



shapes
r0 shape: (16, 864)
r1 shape: (16, 32)
U1 shape: (16, 864, 32)
r2 shape: (128,)
U2 shape: (512, 128)
r3 shape: (212,)
U3 shape: (128, 212)


priors: Li_priors init preview:
r0 first 3: [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
r1 first 3: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0.]]
U1 first 3x3x3: [[[-0.33386649  0.08145698 -0.20055123]
  [-0.41488376  0.12602842 -0.17151185]
  [-0.3909336   0.41153138 -0.46024995]]

 [[-0.02997318 -0.31636064  0.16648171]
  [-0.44596379  0.05242103  0.33571131]
  [ 0.17279118  0.32979036 -0.26824521]]

 [[-0.4122993  -0.00646865  0.04292724]
  [ 0.24950406 -0.04712829 -0.31401514]
  [-0.24717757 -0.34192282 -0.48510557]]]
r2 first 3: [0. 0. 0.]
U2 first 3x3: [[ 0.3524498   0.4767184   0.05718547]
 [ 0.36354175 -0.47865996 -0.28769428]
 [ 0.13794339  0.15473967  0.40288911]]
r3 first 3: [0. 0. 0.]
U3 first 3x3: [[ 0.09784827 -0.07300384  0.39901026]
 [ 0.41329725  0.06820788 -0.11612422]
 [-0.13524043 -0.02059091  0.27099916]]


test: reshaping X into num imgs, num tiles per image, flattened tile
Train init:
X shape: (212, 16, 864)
Y shape: (212, 212)


Epoch: 0
Jr: 33380334.725828536, Jc: 1133.314497948817, Accuracy: 0.0330188679245283
Training...
Epoch 1
eval 1

plot:
loaded diag file:
results/diagnostics/diag.mod.st_tl_3_32-128-212_212_eflL_lin_Li_priors_c1_rW_niters-30_architecture tests_1.pydb
Saved plot:
 results/plots/diag.mod.st_tl_3_32-128-212_212_eflL_lin_Li_priors_c1_rW_niters-30_architecture tests_1.pydb 

Jr: 414235.1806897508, Jc: 1133.568321121032, Accuracy: 0.014150943396226415
Epoch time: 0:01:06.206943.
Est. time remaining: 0:00:00.
Est. tot time: 0:01:06.206943.
Training complete.
Tot time: 0:01:06.207057.
Saving final model...

plot:
loaded diag file:
results/diagnostics/diag.mod.st_tl_3_32-128-212_212_eflL_lin_Li_priors_c1_rW_niters-30_architecture tests_1.pydb
Saved plot:
 results/plots/diag.mod.st_tl_3_32-128-212_212_eflL_lin_Li_priors_c1_rW_niters-30_architecture tests_1.pydb 

Final diagnostics over 1 epochs:
Ep. 0 Jr: 33380334.725828536, Jc: 1133.314497948817, Accuracy: 0.0330188679245283
Ep. 1 Jr: 414235.1806897508, Jc: 1133.568321121032, Accuracy: 0.014150943396226415
Percent diff Jr: 98.7590442573686%, Jc: -0.022396534472514086%, Accuracy: 57.14285714285714%
Change per epoch Jr: 98.7590442573686%, Jc: -0.022396534472514086%, Accuracy: 57.14285714285714%
Change per min Jr: 89.50016696017941%, Jc: -0.020296810177664975%, Accuracy: 51.785588786576454%
