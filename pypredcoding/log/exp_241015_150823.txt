Experiment log begin: log/exp_241015_150823.txt
exp_name: architecture tests Li
notes: architecture tests
train_with: True
evaluate_with: False
predict_with: False
input_shape: (16, 864)
num_tiles: 16
num_layers: 3
hidden_lyr_sizes: [32, 128]
output_lyr_size: 212
architecture: expand_first_lyr
classif_method: c1
priors: Li_priors
lr_denominators: Li_denominators
update_method: {'rW_niters': 30}
softmax_type: normal
softmax_k: 1
model_type: static
tiled_input: True
flat_input: True
activ_func: linear
num_imgs: 212
num_classes: 212
dataset_train: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
epoch_n: 300
kr: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
alph: {1: 1.0, 2: 0.05, 3: 0.05}
lam: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
ssq: {0: 1, 1: 10, 2: 10, 3: 2}
plot_train: True
save_checkpoint: {'save_every': 5}
load_checkpoint: None
batch_size: 1



shapes
r0 shape: (16, 864)
r1 shape: (16, 32)
U1 shape: (16, 864, 32)
r2 shape: (128,)
U2 shape: (16, 32, 128)
r3 shape: (212,)
U3 shape: (128, 212)


priors: Li_priors init preview:
r0 first 3: [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
r1 first 3: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0.]]
U1 first 3x3x3: [[[ 0.18807344 -0.07472202 -0.2936519 ]
  [ 0.49658546 -0.46835517  0.02222038]
  [-0.34801715  0.42093548  0.16472691]]

 [[ 0.476942    0.12246305 -0.47839756]
  [ 0.49748807 -0.45169187  0.12323918]
  [ 0.31931496  0.34024272  0.07793536]]

 [[ 0.17706302  0.37340429  0.18013648]
  [ 0.44610379 -0.13487599  0.42006451]
  [-0.28954168 -0.29289254  0.03538529]]]
r2 first 3: [0. 0. 0.]
U2 first 3x3x3: [[[ 0.33635141  0.39394536  0.11658806]
  [-0.13044015 -0.17076549 -0.34714265]
  [ 0.32329802  0.35525695  0.12535885]]

 [[-0.05616898 -0.11549924  0.06305962]
  [-0.04323785 -0.25697971 -0.21439123]
  [-0.17431718  0.15234673 -0.36496301]]

 [[ 0.2031302  -0.27507116  0.15163724]
  [ 0.08726506 -0.20218512 -0.12929643]
  [-0.00402782  0.02380093 -0.47776191]]]
r3 first 3: [0. 0. 0.]
U3 first 3x3: [[ 0.04598498 -0.10325146 -0.34261988]
 [-0.19102774  0.17582653 -0.33734668]
 [ 0.03523078 -0.21647695 -0.39954263]]


original X shape: (3392, 864)
test: reshaping X into num imgs, num tiles per image, flattened tile
Train init:
X shape: (212, 16, 864)
Y shape: (212, 212)
Checkpoint method: {'save_every': 5} 
 saving every 5


Epoch: 0
Jr: 33375981.112938747, Jc: 1133.3339357042505, Accuracy: 0.04245283018867924
Training...
Epoch 1
