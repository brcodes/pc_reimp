Experiment log begin: log/exp_241015_110629.txt
exp_name: architecture tests Li
notes: architecture tests
train_with: True
evaluate_with: False
predict_with: False
input_shape: (16, 864)
num_tiles: 16
num_layers: 3
hidden_lyr_sizes: [32, 128]
output_lyr_size: 212
architecture: expand_first_lyr_Li
classif_method: c1
priors: Li_priors
lr_denominators: Li_denominators
update_method: {'rW_niters': 30}
softmax_type: normal
softmax_k: 1
model_type: static
tiled_input: True
flat_input: True
activ_func: linear
num_imgs: 212
num_classes: 212
dataset_train: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
epoch_n: 300
kr: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
alph: {1: 1.0, 2: 0.05, 3: 0.05}
lam: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
ssq: {0: 1, 1: 10, 2: 10, 3: 2}
plot_train: True
save_checkpoint: {'save_every': 50}
load_checkpoint: -1
batch_size: 1



shapes
r0 shape: (16, 864)
r1 shape: (16, 32)
U1 shape: (16, 864, 32)
r2 shape: (128,)
U2 shape: (512, 128)
r3 shape: (212,)
U3 shape: (128, 212)


priors: Li_priors init preview:
r0 first 3: [[ 0.          0.         -1.87191818 ...  4.85371278  3.19027875
   3.1557941 ]
 [ 0.          0.         -1.14442204 ...  0.          0.
   0.        ]
 [ 0.          0.          0.         ... -8.80379619 -8.86961889
  -8.9338539 ]]
r1 first 3: [[ 0.29591282  1.70967928 -0.97263135 -0.54934796 -0.87967536  1.96379248
  -0.52827389  0.47793481 -1.20387885 -0.96748704  1.39548854 -0.05090346
   3.33798138  1.48979655 -0.14550108  1.40408918 -0.40403061  1.54987269
   0.658178   -1.17692544 -0.4570371   0.06292465  1.06193895  0.3864306
  -1.02825415 -1.87827906 -1.55735722  0.73691925  1.23928865  0.33797171
   0.95606034 -0.45108961]
 [-0.21227115 -2.73675836  1.05902995  1.53810893 -0.05490366 -0.17294244
  -0.80162562  0.63105021 -0.15830442 -0.61873275 -1.91934368 -0.89631778
   0.43434457  0.7898398   0.82772555  1.48022988 -0.48417309  1.99093668
   1.69530468  0.3917792  -1.2511588  -0.45613581  0.57757193  0.39408415
  -0.07457883 -1.57303519  0.97164591 -1.07440196  1.6551411  -0.15965303
   0.32481435 -1.48806011]
 [ 0.2438767  -0.15608995  2.11755268  0.90257063  2.00950529  0.84016212
   1.62551308  1.05155359 -0.64916659 -0.00419508 -1.6460653   0.86761827
   1.26656298 -1.45662938 -1.79421858  0.79236902 -0.37975536  2.66980597
   1.92588402  0.10342718 -2.26115204  0.69048627 -0.34979149  0.37777576
  -0.80687934  0.56855863 -0.3313083   0.95415958  1.70200699 -0.97680493
   0.50451577 -1.20506902]]
U1 first 3x3x3: [[[ 0.07817319  0.38622243 -0.22170005]
  [ 0.15984798 -0.22704663  0.0324455 ]
  [-0.22438352 -0.15395602 -0.41434121]]

 [[ 0.29876863 -0.36146156  0.0597226 ]
  [ 0.09249471 -0.36108155  0.24736026]
  [ 0.32422736 -0.31784566 -0.27250582]]

 [[ 0.57843011 -0.04635183  0.07359085]
  [-0.37643679 -0.41997639  0.12078604]
  [-0.50202919 -0.27065761  0.20541923]]]
r2 first 3: [ 0.09443198 -0.1018236   0.0973889 ]
U2 first 3x3: [[-0.30859364 -0.17988406 -0.44839054]
 [ 0.19654262  0.15807246  0.35022548]
 [-0.00563269  0.42606206 -0.42055836]]
r3 first 3: [-0.0302348   0.00109146 -0.0081602 ]
U3 first 3x3: [[ 0.47026434  0.38907631 -0.15634352]
 [ 0.22930672 -0.02501581  0.3427733 ]
 [ 0.39218877 -0.12602681  0.3164456 ]]


test: reshaping X into num imgs, num tiles per image, flattened tile
Train init:
X shape: (212, 16, 864)
Y shape: (212, 212)
Checkpoint method: {'save_every': 1} 
 saving every 1


Epoch: 0
Jr: 1517633.3400845788, Jc: 1133.4326402749746, Accuracy: 0.014150943396226415
Training...
Epoch 1
