Experiment log begin: log/exp_241015_133856.txt
exp_name: architecture tests Li
notes: architecture tests
train_with: True
evaluate_with: False
predict_with: False
input_shape: (16, 864)
num_tiles: 16
num_layers: 3
hidden_lyr_sizes: [32, 128]
output_lyr_size: 212
architecture: expand_first_lyr_Li
classif_method: c1
priors: Li_priors
lr_denominators: Li_denominators
update_method: {'rW_niters': 30}
softmax_type: normal
softmax_k: 1
model_type: static
tiled_input: True
flat_input: True
activ_func: linear
num_imgs: 212
num_classes: 212
dataset_train: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
epoch_n: 300
kr: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
alph: {1: 1.0, 2: 0.05, 3: 0.05}
lam: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
ssq: {0: 1, 1: 10, 2: 10, 3: 2}
plot_train: True
save_checkpoint: {'save_every': 50}
load_checkpoint: -1
batch_size: 1



shapes
r0 shape: (16, 864)
r1 shape: (16, 32)
U1 shape: (16, 864, 32)
r2 shape: (128,)
U2 shape: (512, 128)
r3 shape: (212,)
U3 shape: (128, 212)


priors: Li_priors init preview:
r0 first 3: [[ 0.          0.         -1.87191818 ...  4.85371278  3.19027875
   3.1557941 ]
 [ 0.          0.         -1.14442204 ...  0.          0.
   0.        ]
 [ 0.          0.          0.         ... -8.80379619 -8.86961889
  -8.9338539 ]]
r1 first 3: [[ 1.19660548e+00  1.99474312e-01 -9.07819535e-02  6.10458075e-01
   1.11823839e-01 -4.06715975e-02 -2.31232883e-02 -3.37607126e-01
   1.46162594e-01 -8.28452642e-02  4.37356669e-01  9.08995779e-01
  -1.94074335e+00  4.34747052e-02  6.80885638e-01 -5.89388915e-01
  -4.01508610e-01 -3.34299570e-01 -9.70562217e-02 -1.54252735e-01
   3.46514854e-01  3.84173344e-01 -1.96765652e-01  1.17010799e-01
   2.75515019e-02  2.75770006e+00  4.70481908e-01 -1.35357661e+00
   2.32579529e-02  9.65609565e-02  3.24518068e-01 -2.27091346e-01]
 [-2.05103861e+00 -1.09797995e+00  3.03277784e-01 -2.71907948e-01
   7.05970047e-02  1.17416151e+00 -2.33999530e-01 -7.26250988e-01
  -1.09668872e-01 -4.56951024e-01  2.38163300e-01  6.06684458e-01
  -1.19698210e-01 -9.90447343e-01  7.33349908e-01 -5.43285652e-01
   7.35566693e-01  6.95533836e-01  1.10554158e+00  9.00259076e-01
   1.23257692e+00 -1.13664658e-01  1.90527540e-02 -4.57838338e-02
   4.99386141e-01 -8.08409326e-01 -5.02023319e-01 -1.11929174e+00
   1.07765901e+00  1.20919938e-01  1.69648802e-01 -4.36444915e-01]
 [-1.47128036e+00  4.32947112e-01  8.12144635e-01  1.04831207e-01
   5.45638282e-01 -2.56662947e-01 -3.19975249e-01  3.55746979e-01
  -3.33682711e-01 -2.45511766e-01  3.95065398e-01  7.66810864e-01
   5.21474574e-01 -1.30043817e+00 -7.71889594e-01  4.07429181e-01
   1.15871856e-01  7.95654842e-01 -3.46372761e-01  7.95542604e-02
  -3.37111223e-01  5.64871544e-01 -9.78248244e-02 -1.26447879e-01
  -1.37996443e+00 -1.91006346e-03  6.47300853e-01 -1.95003531e-02
   1.84510023e+00 -8.02821088e-01  8.26144196e-01 -3.52317458e-01]]
U1 first 3x3x3: [[[-0.18797169 -0.11137267 -0.17658666]
  [ 0.12640127 -0.07201654  0.16824744]
  [-0.30811133  0.27537181  0.22317622]]

 [[ 0.10976417  0.11567631  0.00208076]
  [-0.14109627  0.03997721  0.194233  ]
  [ 0.15087997  0.15984024 -0.12218376]]

 [[-0.04250953 -0.23558456 -0.24221144]
  [-0.04587013 -0.22947193 -0.18180794]
  [-0.27524525  0.34635378  0.13289003]]]
r2 first 3: [-0.0584255  -0.06563454  0.07516581]
U2 first 3x3: [[ 0.09710679  0.08255022 -0.42525423]
 [ 0.15703199 -0.2480801   0.40513999]
 [-0.4340697  -0.11271473  0.24889039]]
r3 first 3: [-0.01060707  0.00292731 -0.03636756]
U3 first 3x3: [[ 0.02232666  0.0050694   0.34794303]
 [ 0.16463013  0.34925286  0.04329527]
 [-0.10415273 -0.25321552 -0.03192351]]


test: reshaping X into num imgs, num tiles per image, flattened tile
Train init:
X shape: (212, 16, 864)
Y shape: (212, 212)
Checkpoint method: {'save_every': 50} 
 saving every 50


Epoch: 0
Jr: 64263.093738654665, Jc: 1133.2632010247378, Accuracy: 0.018867924528301886
Training...
Epoch 1
