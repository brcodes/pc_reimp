exp_name: Experiment_2024_09_10
train_with: True
evaluate_with: False
predict_with: False
notes:  212 train - cost and updates normalized by num terms, and balance factor added
model_type: static
tiled: True
num_tiles: 16
flat_input: True
num_layers: 3
input_shape: (16, 864)
hidden_lyr_sizes: [32, 128]
output_lyr_size: 212
classif_method: c2
activ_func: linear
priors: kurtotic
update_method: {'rW_niters': 30}
cost_norm: num_terms
num_imgs: 212
num_classes: 212
dataset_train: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
batch_size: 1
epoch_n: 10
kr: {1: 1e-05, 2: 1e-05, 3: 1e-05, 'o': 1e-05}
kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
kV: {1: 0.05, 2: 0.05, 3: 0.05}
alph: {1: 1.0, 2: 0.05, 3: 0.05}
lam: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
ssq: {1: 2, 2: 2, 3: 2, 'o': 2}
save_checkpoint: {'save_every': 50}
load_checkpoint: None
online_diagnostics: True
plot_train: True
dataset_eval: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_eval: first
dataset_pred: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_pred: first



priors: kurtotic init preview:
r0 shape: (16, 864)
r0 first 3: [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
r1 shape: (32,)
r1 first 3: [-0.04958928 -1.01579243  0.21573622]
U1 shape: (16, 864, 32)
U1 first 3x3x3: [[[-0.02174219 -0.05189644  0.54401278]
  [-0.24833112  0.19842908  0.4955124 ]
  [ 0.35473695  0.11144554  0.38758548]]

 [[-0.53788672  0.34706957 -0.10098809]
  [-0.36684457 -0.44694157  0.07334842]
  [ 0.09601954  0.00248534 -0.21911954]]

 [[ 0.57874164  0.28448703  0.05239336]
  [-0.58102591  0.18228572  0.11059781]
  [ 0.31738466  0.30010546  0.30554712]]]
r2 shape: (128,)
r2 first 3: [-0.58200515  0.80536674 -0.4109021 ]
U2 shape: (32, 128)
U2 first 3x3: [[ 0.27022187  0.5084726   0.41524606]
 [-1.45917954 -1.05721192 -0.72003409]
 [ 0.61819978  1.14675226 -0.97082616]]
r3 shape: (212,)
r3 first 3: [0.12845909 0.00499661 0.29547712]
U3 shape: (128, 212)
U3 first 3x3: [[-0.83263832 -0.51512622  1.28986043]
 [ 1.70551554  0.09771452 -0.3308284 ]
 [-0.77326642  0.44120622  0.80123548]]
Uo shape: (212, 212)
Uo first 3x3: [[ 0.79643811  2.58727049  0.22995262]
 [ 1.48369251 -0.96000446  0.53317964]
 [ 0.0497439   0.18703642 -0.02469902]]
einsum arg U1: ij,k->ijk
test: reshaping X into num imgs, num tiles per image, flattened tile
Train init:
X shape (incl. test reshape): (212, 16, 864)
Y shape: (212, 212)
self.all_lyr_sizes: {1: 32, 2: 128, 3: 212}
self.U_sizes: {1: 442368, 2: 4096, 3: 27136, 'o': 44944}
self.r_size_divisors: {0: 13824, 1: 32, 2: 128, 3: 212}
self.U_size_divisors: {1: 442368, 2: 4096, 3: 27136, 'o': 44944}
self.Jr_term_divisors: {1: 4, 2: 4, 3: 3}
self.Jc_term_divisor: 2
self.r_term_divisors: {1: 3, 2: 3, 3: 3}
self.U_term_divisors: {1: 2, 2: 2, 3: 2, 'o': 2}
self.kr: {1: 1e-05, 2: 1e-05, 3: 1e-05, 'o': 1e-05}
self.kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
self.update_method: {'rW_niters': 30}
update_method_name: rW_niters
update_method_number: 30
classif_method: c2


Diagnostics on
Epoch: 0
Jr: 52.74968072799267, Jc: 10.062338609600493, Accuracy: 0.0047169811320754715
balance term 0: 5.242288375951105
Jr: 10.062338609600493, Jc: 10.062338609600493, Accuracy: 0.0047169811320754715
Training...
Epoch 1
