exp_name: Experiment_2024_09_10
train_with: True
evaluate_with: False
predict_with: False
notes:  212 train - cost and updates normalized by num terms, and balance factor added
model_type: static
tiled: True
num_tiles: 16
flat_input: True
num_layers: 3
input_shape: (16, 864)
hidden_lyr_sizes: [32, 128]
output_lyr_size: 212
classif_method: c1
activ_func: linear
priors: kurtotic
update_method: {'r_niters_W': 100}
cost_norm: num_terms
num_imgs: 212
num_classes: 212
dataset_train: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
batch_size: 1
epoch_n: 10
kr: {1: 1e-05, 2: 1e-05, 3: 1e-05, 'o': 1e-05}
kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
kV: {1: 0.05, 2: 0.05, 3: 0.05}
alph: {1: 1.0, 2: 0.05, 3: 0.05}
lam: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
ssq: {1: 2, 2: 2, 3: 2, 'o': 2}
save_checkpoint: {'save_every': 50}
load_checkpoint: None
online_diagnostics: True
plot_train: True
dataset_eval: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_eval: first
dataset_pred: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_pred: first



priors: kurtotic init preview:
r0 shape: (16, 864)
r0 first 3: [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
r1 shape: (32,)
r1 first 3: [0.15839085 0.04042401 1.95567823]
U1 shape: (16, 864, 32)
U1 first 3x3x3: [[[-0.08154568 -0.40686296  0.47712698]
  [ 0.61008051  0.66280397 -0.41187593]
  [ 0.29034157 -1.39948595  0.35002175]]

 [[-0.59232431  1.47284177  0.14690915]
  [ 0.20793704  0.4602237  -0.90015792]
  [-0.26065434  0.2183039  -0.34532256]]

 [[-0.71540563 -0.03917974  0.51211782]
  [ 0.13297664 -0.07764304 -0.23428467]
  [-0.16633874 -0.21474418 -0.10883007]]]
r2 shape: (128,)
r2 first 3: [-1.58761533  0.52820678 -0.01761563]
U2 shape: (32, 128)
U2 first 3x3: [[ 0.1000206   0.64561319  0.05625128]
 [-0.74093833 -0.66534156 -1.26996695]
 [-0.48589586 -0.03553184  0.80781284]]
r3 shape: (212,)
r3 first 3: [ 0.52110756  1.87147402 -1.12204482]
U3 shape: (128, 212)
U3 first 3x3: [[-0.08366851 -0.40251409 -0.23622344]
 [-0.20086514 -0.82106778 -1.41554032]
 [-0.32824501 -1.40271813 -0.0170474 ]]
einsum arg U1: ij,k->ijk
test: reshaping X into num imgs, num tiles per image, flattened tile
Train init:
X shape (incl. test reshape): (212, 16, 864)
Y shape: (212, 212)
self.all_lyr_sizes: {1: 32, 2: 128, 3: 212}
self.U_sizes: {1: 442368, 2: 4096, 3: 27136}
self.r_size_divisors: {0: 13824, 1: 32, 2: 128, 3: 212}
self.U_size_divisors: {1: 442368, 2: 4096, 3: 27136}
self.Jr_term_divisors: {1: 4, 2: 4, 3: 3}
self.Jc_term_divisor: 1
self.r_term_divisors: {1: 3, 2: 3, 3: 3}
self.U_term_divisors: {1: 2, 2: 2, 3: 2}
self.kr: {1: 1e-05, 2: 1e-05, 3: 1e-05, 'o': 1e-05}
self.kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
self.update_method: {'r_niters_W': 100}
update_method_name: r_niters_W
update_method_number: 100
classif_method: c1


Diagnostics on
Epoch: 0
Jr: 51.473915662950766, Jc: 5.623211197534073, Accuracy: 0.0047169811320754715
balance term 0: 9.153829343191562
Jr: 5.623211197534073, Jc: 5.623211197534073, Accuracy: 0.0047169811320754715
Training...
Epoch 1
eval 1
Jr: 4.475924344778588, Jc: 5.611097536495901, Accuracy: 0.0047169811320754715
Epoch time: 0:00:26.089361.
Est. time remaining: 0:03:54.804249.
Est. tot time: 0:04:20.893610.
Epoch 2
eval 2
Jr: 4.342509075355402, Jc: 5.609593182035157, Accuracy: 0.0047169811320754715
Epoch time: 0:00:25.752529.
Est. time remaining: 0:03:26.020232.
Epoch 3
eval 3
Jr: 4.214868971901671, Jc: 5.6080470271998575, Accuracy: 0.0047169811320754715
Epoch time: 0:00:26.555326.
Est. time remaining: 0:03:05.887282.
Epoch 4
eval 4
Jr: 4.092719251524913, Jc: 5.606521048345323, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.661252.
Est. time remaining: 0:02:45.967512.
Epoch 5
eval 5
Jr: 3.975780022429742, Jc: 5.605187039427184, Accuracy: 0.0047169811320754715
Epoch time: 0:00:26.393335.
Est. time remaining: 0:02:11.966675.
Epoch 6
eval 6
Jr: 3.86379539670906, Jc: 5.603792192446555, Accuracy: 0.0047169811320754715
Epoch time: 0:00:26.305661.
Est. time remaining: 0:01:45.222644.
Epoch 7
eval 7
Jr: 3.7565149351571474, Jc: 5.60234302937856, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.279634.
Est. time remaining: 0:01:21.838902.
Epoch 8
eval 8
Jr: 3.6537091526998933, Jc: 5.60094575693846, Accuracy: 0.0047169811320754715
Epoch time: 0:00:26.995001.
Est. time remaining: 0:00:53.990002.
Epoch 9
eval 9
Jr: 3.5551537080612987, Jc: 5.599566794620879, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.210522.
Est. time remaining: 0:00:27.210522.
Epoch 10
eval 10
Jr: 3.4606454127142974, Jc: 5.598368603790911, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.346358.
Est. time remaining: 0:00:00.
Training complete.
Tot time: 0:04:27.593471.
Saving final model...



Final diagnostics over 10 epochs:
Ep. 0 Jr: 5.623211197534073, Jc: 5.623211197534073, Accuracy: 0.0047169811320754715
Ep. 10 Jr: 3.4606454127142974, Jc: 5.598368603790911, Accuracy: 0.0047169811320754715
Percent diff Jr: 38.45784390542041, Jc: 0.44178660325004177, Accuracy: 0.0
Change per epoch Jr: 3.845784390542041, Jc: 0.04417866032500418, Accuracy: 0.0
Change per min Jr: 8.623045344500294, Jc: 0.0990577090537553, Accuracy: 0.0
