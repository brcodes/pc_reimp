exp_name: Experiment_2024_09_10
train_with: True
evaluate_with: False
predict_with: False
notes:  212 train - cost and updates normalized by num terms, and balance factor added
model_type: static
tiled: True
num_tiles: 16
flat_input: True
num_layers: 3
input_shape: (16, 864)
hidden_lyr_sizes: [32, 128]
output_lyr_size: 212
classif_method: c2
activ_func: linear
priors: kurtotic
update_method: {'rW_niters': 30}
cost_norm: num_terms
num_imgs: 212
num_classes: 212
dataset_train: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
batch_size: 1
epoch_n: 10
kr: {1: 0.0001, 2: 0.0001, 3: 0.0001, 'o': 0.0001}
kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
kV: {1: 0.05, 2: 0.05, 3: 0.05}
alph: {1: 1.0, 2: 0.05, 3: 0.05}
lam: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
ssq: {1: 2, 2: 2, 3: 2, 'o': 2}
save_checkpoint: {'save_every': 50}
load_checkpoint: None
online_diagnostics: True
plot_train: True
dataset_eval: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_eval: first
dataset_pred: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_pred: first



priors: kurtotic init preview:
r0 shape: (16, 864)
r0 first 3: [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
r1 shape: (32,)
r1 first 3: [ 0.96342634 -0.07855752  0.82629895]
U1 shape: (16, 864, 32)
U1 first 3x3x3: [[[ 0.10798179 -0.22823984  0.95669367]
  [-0.52256456 -0.54081371  2.06148128]
  [ 0.35707611 -0.33370687  0.67134501]]

 [[-0.05048087 -0.70705792 -0.63001469]
  [-0.77151377 -0.01904391 -0.77891989]
  [ 1.43985761  0.42293626  0.2357151 ]]

 [[-0.73336535  1.05053346 -2.89920038]
  [-0.93640091 -0.12482451 -0.45386745]
  [ 0.81875613 -0.09125871  0.2142594 ]]]
r2 shape: (128,)
r2 first 3: [ 0.66197385 -0.37323695 -1.66333866]
U2 shape: (32, 128)
U2 first 3x3: [[-0.30754111 -0.02921537  0.60678823]
 [-1.374022    0.84292712 -0.48224998]
 [-0.0337647  -0.29149832 -0.30769701]]
r3 shape: (212,)
r3 first 3: [0.34393301 0.25816667 0.2887178 ]
U3 shape: (128, 212)
U3 first 3x3: [[ 1.35431049 -0.0993296  -0.51073334]
 [-1.40803808 -0.74789248 -2.31739357]
 [ 0.31356008 -0.29317491  0.09033089]]
Uo shape: (212, 212)
Uo first 3x3: [[ 0.84062628 -5.09707244 -0.03945473]
 [ 0.48687859  0.83563816  0.33594802]
 [-1.6852532   0.00699823 -1.52575121]]
einsum arg U1: ij,k->ijk
test: reshaping X into num imgs, num tiles per image, flattened tile
Train init:
X shape (incl. test reshape): (212, 16, 864)
Y shape: (212, 212)
self.all_lyr_sizes: {1: 32, 2: 128, 3: 212}
self.U_sizes: {1: 442368, 2: 4096, 3: 27136, 'o': 44944}
self.r_size_divisors: {0: 13824, 1: 32, 2: 128, 3: 212}
self.U_size_divisors: {1: 442368, 2: 4096, 3: 27136, 'o': 44944}
self.Jr_term_divisors: {1: 4, 2: 4, 3: 3}
self.Jc_term_divisor: 2
self.r_term_divisors: {1: 3, 2: 3, 3: 3}
self.U_term_divisors: {1: 2, 2: 2, 3: 2, 'o': 2}
self.kr: {1: 0.0001, 2: 0.0001, 3: 0.0001, 'o': 0.0001}
self.kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
self.update_method: {'rW_niters': 30}
update_method_name: rW_niters
update_method_number: 30
classif_method: c2


Diagnostics on
Epoch: 0
Jr: 44.346815862915115, Jc: 11.33567077561149, Accuracy: 0.0047169811320754715
balance term 0: 3.9121474803526017
Jr: 11.33567077561149, Jc: 11.33567077561149, Accuracy: 0.0047169811320754715
Training...
Epoch 1
eval 1
Jr: 6.030854851775136, Jc: 10.691386999707602, Accuracy: 0.0047169811320754715
Epoch time: 0:01:07.331209.
Est. time remaining: 0:10:05.980881.
Est. tot time: 0:11:13.312090.
Epoch 2
eval 2
Jr: 5.080841048499963, Jc: 10.510184872987324, Accuracy: 0.0047169811320754715
Epoch time: 0:01:07.007852.
Est. time remaining: 0:08:56.062816.
Epoch 3
eval 3
Jr: 4.336501355863233, Jc: 10.340038264006772, Accuracy: 0.0047169811320754715
Epoch time: 0:01:07.349034.
Est. time remaining: 0:07:51.443238.
Epoch 4
eval 4
Jr: 3.746057487503163, Jc: 10.181248580383281, Accuracy: 0.0047169811320754715
Epoch time: 0:01:07.207143.
Est. time remaining: 0:06:43.242858.
Epoch 5
eval 5
Jr: 3.2721277813042464, Jc: 10.030390491912192, Accuracy: 0.0047169811320754715
Epoch time: 0:01:07.371195.
Est. time remaining: 0:05:36.855975.
Epoch 6
eval 6
Jr: 2.8874774923439577, Jc: 9.88997843497784, Accuracy: 0.0047169811320754715
Epoch time: 0:01:07.333546.
Est. time remaining: 0:04:29.334184.
Epoch 7
eval 7
Jr: 2.5719136335441233, Jc: 9.761225956197734, Accuracy: 0.0047169811320754715
Epoch time: 0:01:07.479303.
Est. time remaining: 0:03:22.437909.
Epoch 8
eval 8
Jr: 2.310363552316092, Jc: 9.642593347732046, Accuracy: 0.0047169811320754715
Epoch time: 0:01:10.527915.
Est. time remaining: 0:02:21.055830.
Epoch 9
eval 9
Jr: 2.091408272389439, Jc: 9.534293161951453, Accuracy: 0.0047169811320754715
Epoch time: 0:01:08.167934.
Est. time remaining: 0:01:08.167934.
Epoch 10
eval 10
Jr: 1.9063631224287039, Jc: 9.434013962183643, Accuracy: 0.0047169811320754715
Epoch time: 0:01:07.453208.
Est. time remaining: 0:00:00.
Training complete.
Tot time: 0:11:17.233925.
Saving final model...



Final diagnostics over 10 epochs:
Ep. 0 Jr: 11.33567077561149, Jc: 11.33567077561149, Accuracy: 0.0047169811320754715
Ep. 10 Jr: 1.9063631224287039, Jc: 9.434013962183643, Accuracy: 0.0047169811320754715
Percent diff Jr: 83.18261741925133, Jc: 16.775864887671492, Accuracy: 0.0
Change per epoch Jr: 8.318261741925133, Jc: 1.6775864887671492, Accuracy: 0.0
Change per min Jr: 7.369620541609872, Jc: 1.4862691547241813, Accuracy: 0.0
