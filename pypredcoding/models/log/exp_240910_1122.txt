exp_name: Experiment_2024_09_10
train_with: True
evaluate_with: False
predict_with: False
notes:  212 train - cost and updates normalized by num terms, and balance factor added
model_type: static
tiled: True
num_tiles: 16
flat_input: True
num_layers: 3
input_shape: (16, 864)
hidden_lyr_sizes: [32, 128]
output_lyr_size: 212
classif_method: c1
activ_func: linear
priors: kurtotic
update_method: {'r_eq_W': 0.05}
cost_norm: num_terms
num_imgs: 212
num_classes: 212
dataset_train: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
batch_size: 1
epoch_n: 10
kr: {1: 1e-05, 2: 1e-05, 3: 1e-05, 'o': 1e-05}
kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
kV: {1: 0.05, 2: 0.05, 3: 0.05}
alph: {1: 1.0, 2: 0.05, 3: 0.05}
lam: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
ssq: {1: 2, 2: 2, 3: 2, 'o': 2}
save_checkpoint: {'save_every': 50}
load_checkpoint: None
online_diagnostics: True
plot_train: True
dataset_eval: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_eval: first
dataset_pred: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_pred: first



priors: kurtotic init preview:
r0 shape: (16, 864)
r0 first 3: [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
r1 shape: (32,)
r1 first 3: [1.04271299 0.05746163 0.2313096 ]
U1 shape: (16, 864, 32)
U1 first 3x3x3: [[[-0.21040629  0.0740582   0.0023094 ]
  [-0.08138379 -0.15025924  0.52059094]
  [ 0.67264955  0.81545297  0.90481705]]

 [[ 0.21448803 -0.30656349 -0.95851965]
  [-0.87000475 -0.64800994 -0.31807823]
  [-0.06004928 -0.15365871 -0.62403101]]

 [[ 1.43043058 -0.76158982  0.0741613 ]
  [ 0.36602902 -0.07428649 -0.31455463]
  [ 0.36158533 -0.89976093  0.09587256]]]
r2 shape: (128,)
r2 first 3: [-0.24672939  0.25014736 -0.29227369]
U2 shape: (32, 128)
U2 first 3x3: [[-0.31804401  0.20865836  1.21696316]
 [ 0.04076001 -0.84636909 -0.13744774]
 [-0.47903766  1.34694497 -0.26212014]]
r3 shape: (212,)
r3 first 3: [-0.17588374 -1.09913839 -0.05018229]
U3 shape: (128, 212)
U3 first 3x3: [[-0.25946493  1.44738533  1.18566574]
 [-0.0068657   0.10988065 -0.69920832]
 [ 0.02351008 -0.81800182 -1.63146189]]
einsum arg U1: ij,k->ijk
test: reshaping X into num imgs, num tiles per image, flattened tile
Train init:
X shape (incl. test reshape): (212, 16, 864)
Y shape: (212, 212)
self.all_lyr_sizes: {1: 32, 2: 128, 3: 212}
self.U_sizes: {1: 442368, 2: 4096, 3: 27136}
self.r_size_divisors: {0: 13824, 1: 32, 2: 128, 3: 212}
self.U_size_divisors: {1: 442368, 2: 4096, 3: 27136}
self.Jr_term_divisors: {1: 4, 2: 4, 3: 3}
self.Jc_term_divisor: 1
self.r_term_divisors: {1: 3, 2: 3, 3: 3}
self.U_term_divisors: {1: 2, 2: 2, 3: 2}
self.kr: {1: 1e-05, 2: 1e-05, 3: 1e-05, 'o': 1e-05}
self.kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
self.update_method: {'r_eq_W': 0.05}
update_method_name: r_eq_W
update_method_number: 0.05
classif_method: c1


Diagnostics on
Epoch: 0
Jr: 69.8160157282822, Jc: 5.559648938795586, Accuracy: 0.0047169811320754715
balance term 0: 12.557630256310173
Jr: 5.559648938795586, Jc: 5.559648938795586, Accuracy: 0.0047169811320754715
Training...
Epoch 1
eval 1
Jr: 5.545158768775559, Jc: 5.559547203427974, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.458546.
Est. time remaining: 0:00:31.126914.
Est. tot time: 0:00:34.585460.
Epoch 2
eval 2
Jr: 5.542935690285993, Jc: 5.5595362959416486, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.405438.
Est. time remaining: 0:00:27.243504.
Epoch 3
eval 3
Jr: 5.540713809368664, Jc: 5.559525484289313, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.833210.
Est. time remaining: 0:00:26.832470.
Epoch 4
eval 4
Jr: 5.538493131802251, Jc: 5.559514276439515, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.730353.
Est. time remaining: 0:00:22.382118.
Epoch 5
eval 5
Jr: 5.536273653498809, Jc: 5.559502932264195, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.763825.
Est. time remaining: 0:00:18.819125.
Epoch 6
eval 6
Jr: 5.53405537415096, Jc: 5.55949215995314, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.788223.
Est. time remaining: 0:00:15.152892.
Epoch 7
eval 7
Jr: 5.5318382906842025, Jc: 5.559480310941895, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.628278.
Est. time remaining: 0:00:10.884834.
Epoch 8
eval 8
Jr: 5.529622404267669, Jc: 5.559469197742768, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.642964.
Est. time remaining: 0:00:07.285928.
Epoch 9
eval 9
Jr: 5.527407715216284, Jc: 5.559457985366723, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.690475.
Est. time remaining: 0:00:03.690475.
Epoch 10
eval 10
Jr: 5.525194219743507, Jc: 5.559446930824604, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.742536.
Est. time remaining: 0:00:00.
Training complete.
Tot time: 0:00:36.687936.
Saving final model...



Final diagnostics over 10 epochs:
Ep. 0 Jr: 5.559648938795586, Jc: 5.559648938795586, Accuracy: 0.0047169811320754715
Ep. 10 Jr: 5.525194219743507, Jc: 5.559446930824604, Accuracy: 0.0047169811320754715
Percent diff Jr: 0.6197283215429698, Jc: 0.0036334663070591647, Accuracy: 0.0
Change per epoch Jr: 0.061972832154296977, Jc: 0.0003633466307059165, Accuracy: 0.0
Change per min Jr: 1.0135129785599872, Jc: 0.005942225216036953, Accuracy: 0.0
