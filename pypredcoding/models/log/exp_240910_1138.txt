exp_name: Experiment_2024_09_10
train_with: True
evaluate_with: False
predict_with: False
notes:  212 train - cost and updates normalized by num terms, and balance factor added
model_type: static
tiled: True
num_tiles: 16
flat_input: True
num_layers: 3
input_shape: (16, 864)
hidden_lyr_sizes: [32, 128]
output_lyr_size: 212
classif_method: c1
activ_func: linear
priors: kurtotic
update_method: {'r_eq_W': 0.05}
cost_norm: num_terms
num_imgs: 212
num_classes: 212
dataset_train: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
batch_size: 1
epoch_n: 10
kr: {1: 0.0001, 2: 0.0001, 3: 0.0001, 'o': 0.0001}
kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
kV: {1: 0.05, 2: 0.05, 3: 0.05}
alph: {1: 1.0, 2: 0.05, 3: 0.05}
lam: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
ssq: {1: 2, 2: 2, 3: 2, 'o': 2}
save_checkpoint: {'save_every': 50}
load_checkpoint: None
online_diagnostics: True
plot_train: True
dataset_eval: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_eval: first
dataset_pred: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_pred: first



priors: kurtotic init preview:
r0 shape: (16, 864)
r0 first 3: [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
r1 shape: (32,)
r1 first 3: [ 0.15138813 -0.21655343  0.03710946]
U1 shape: (16, 864, 32)
U1 first 3x3x3: [[[ 0.32782115 -0.10629316 -0.87502407]
  [-0.14066989 -0.03133805  0.34430905]
  [ 0.39712159 -0.03382674 -0.20085394]]

 [[ 0.09303515  0.32559541  0.7152112 ]
  [-0.18185255  0.51068254 -1.58157978]
  [ 0.15204773 -0.10974976 -0.09698663]]

 [[-0.28519796 -0.06331959 -0.04506624]
  [-0.3737422   0.36615392 -0.36388974]
  [-0.27258677 -0.30440477  1.42684258]]]
r2 shape: (128,)
r2 first 3: [ 1.24781579 -0.14581919 -0.10832065]
U2 shape: (32, 128)
U2 first 3x3: [[-0.86918206  0.29458716  0.35850795]
 [ 0.38521633 -0.43669778  0.24176819]
 [-0.06392302 -0.70276913  0.0095433 ]]
r3 shape: (212,)
r3 first 3: [-0.43436995  0.21010799  0.17549073]
U3 shape: (128, 212)
U3 first 3x3: [[-0.02526143 -0.07176724  0.21573212]
 [ 0.3442673   0.5380098   0.18963799]
 [ 0.41862813  0.32031526  0.40495032]]
einsum arg U1: ij,k->ijk
test: reshaping X into num imgs, num tiles per image, flattened tile
Train init:
X shape (incl. test reshape): (212, 16, 864)
Y shape: (212, 212)
self.all_lyr_sizes: {1: 32, 2: 128, 3: 212}
self.U_sizes: {1: 442368, 2: 4096, 3: 27136}
self.r_size_divisors: {0: 13824, 1: 32, 2: 128, 3: 212}
self.U_size_divisors: {1: 442368, 2: 4096, 3: 27136}
self.Jr_term_divisors: {1: 4, 2: 4, 3: 3}
self.Jc_term_divisor: 1
self.r_term_divisors: {1: 3, 2: 3, 3: 3}
self.U_term_divisors: {1: 2, 2: 2, 3: 2}
self.kr: {1: 0.0001, 2: 0.0001, 3: 0.0001, 'o': 0.0001}
self.kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
self.update_method: {'r_eq_W': 0.05}
update_method_name: r_eq_W
update_method_number: 0.05
classif_method: c1


Diagnostics on
Epoch: 0
Jr: 46.41732851593508, Jc: 5.651707404060955, Accuracy: 0.0047169811320754715
balance term 0: 8.212974451328206
Jr: 5.651707404060955, Jc: 5.651707404060955, Accuracy: 0.0047169811320754715
Training...
Epoch 1
eval 1
Jr: 5.537879759585275, Jc: 5.650112876702299, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.288111.
Est. time remaining: 0:00:29.592999.
Est. tot time: 0:00:32.881110.
Epoch 2
eval 2
Jr: 5.519817544918846, Jc: 5.649870087372582, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.315047.
Est. time remaining: 0:00:26.520376.
Epoch 3
eval 3
Jr: 5.50184366590884, Jc: 5.649614027046342, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.218520.
Est. time remaining: 0:00:22.529640.
Epoch 4
eval 4
Jr: 5.483957567600113, Jc: 5.649372452940835, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.326171.
Est. time remaining: 0:00:19.957026.
Epoch 5
eval 5
Jr: 5.4661591729525645, Jc: 5.649136265242728, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.293072.
Est. time remaining: 0:00:16.465360.
Epoch 6
eval 6
Jr: 5.448447226805855, Jc: 5.648886444855647, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.414099.
Est. time remaining: 0:00:13.656396.
Epoch 7
eval 7
Jr: 5.430821742364185, Jc: 5.6486346411146275, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.649282.
Est. time remaining: 0:00:10.947846.
Epoch 8
eval 8
Jr: 5.413282139075614, Jc: 5.648388279205109, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.504713.
Est. time remaining: 0:00:07.009426.
Epoch 9
eval 9
Jr: 5.39582775774408, Jc: 5.648150640565981, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.462067.
Est. time remaining: 0:00:03.462067.
Epoch 10
eval 10
Jr: 5.378458194440828, Jc: 5.6479021207232085, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.304848.
Est. time remaining: 0:00:00.
Training complete.
Tot time: 0:00:33.781226.
Saving final model...



Final diagnostics over 10 epochs:
Ep. 0 Jr: 5.651707404060955, Jc: 5.651707404060955, Accuracy: 0.0047169811320754715
Ep. 10 Jr: 5.378458194440828, Jc: 5.6479021207232085, Accuracy: 0.0047169811320754715
Percent diff Jr: 4.8348081399930205, Jc: 0.06732980081404506, Accuracy: 0.0
Change per epoch Jr: 0.48348081399930204, Jc: 0.006732980081404506, Accuracy: 0.0
Change per min Jr: 8.587269402228955, Jc: 0.11958678020870836, Accuracy: 0.0
