exp_name: Experiment_2024_09_10
train_with: True
evaluate_with: False
predict_with: False
notes:  212 train - cost and updates normalized by num terms, and balance factor added
model_type: static
tiled: True
num_tiles: 16
flat_input: True
num_layers: 3
input_shape: (16, 864)
hidden_lyr_sizes: [32, 128]
output_lyr_size: 212
classif_method: c2
activ_func: linear
priors: kurtotic
update_method: {'rW_niters': 30}
cost_norm: num_terms
num_imgs: 212
num_classes: 212
dataset_train: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
batch_size: 1
epoch_n: 10
kr: {1: 1e-05, 2: 1e-05, 3: 1e-05, 'o': 1e-05}
kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
kV: {1: 0.05, 2: 0.05, 3: 0.05}
alph: {1: 1.0, 2: 0.05, 3: 0.05}
lam: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
ssq: {1: 2, 2: 2, 3: 2, 'o': 2}
save_checkpoint: {'save_every': 50}
load_checkpoint: None
online_diagnostics: True
plot_train: True
dataset_eval: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_eval: first
dataset_pred: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_pred: first



priors: kurtotic init preview:
r0 shape: (16, 864)
r0 first 3: [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
r1 shape: (32,)
r1 first 3: [ 0.15860199  0.03722893 -4.0054937 ]
U1 shape: (16, 864, 32)
U1 first 3x3x3: [[[ 0.5564865  -0.40190657 -1.48337276]
  [-0.16215014  1.13009058  2.29826052]
  [-0.36463772 -0.31439983 -0.7749938 ]]

 [[ 0.73593115 -0.7022741  -0.78543863]
  [ 0.32805194 -0.44389022 -0.02076247]
  [ 0.10211767 -0.25623319 -0.46051925]]

 [[-0.45603766  1.17145456 -0.21078797]
  [ 0.1219687   0.32140179 -0.47883557]
  [ 0.09453142  0.17476502 -0.80866565]]]
r2 shape: (128,)
r2 first 3: [-0.43291725  0.64902981 -0.21616217]
U2 shape: (32, 128)
U2 first 3x3: [[-7.69572784e-04  1.87374021e-01  3.59652834e-01]
 [-4.00671178e-02 -1.18236050e+00  1.13279750e-01]
 [-8.76415531e-01 -3.08454152e-01  3.48450813e-01]]
r3 shape: (212,)
r3 first 3: [-0.6623903   0.02690392  0.63565671]
U3 shape: (128, 212)
U3 first 3x3: [[ 1.02413973e-02 -2.78954323e-01 -8.90349720e-01]
 [-1.20643303e-04 -1.88412169e+00 -4.69072196e-01]
 [ 8.48446349e-02 -1.24865656e-01  3.22256114e-01]]
Uo shape: (212, 212)
Uo first 3x3: [[-0.63180138  0.00554718 -1.24658604]
 [ 0.80686446 -0.21895556  0.03884868]
 [-0.23454491 -0.12180754 -0.38549075]]
einsum arg U1: ij,k->ijk
test: reshaping X into num imgs, num tiles per image, flattened tile
Train init:
X shape (incl. test reshape): (212, 16, 864)
Y shape: (212, 212)
self.all_lyr_sizes: {1: 32, 2: 128, 3: 212}
self.U_sizes: {1: 442368, 2: 4096, 3: 27136, 'o': 44944}
self.r_size_divisors: {0: 13824, 1: 32, 2: 128, 3: 212}
self.U_size_divisors: {1: 442368, 2: 4096, 3: 27136, 'o': 44944}
self.Jr_term_divisors: {1: 4, 2: 4, 3: 3}
self.Jc_term_divisor: 2
self.r_term_divisors: {1: 3, 2: 3, 3: 3}
self.U_term_divisors: {1: 2, 2: 2, 3: 2, 'o': 2}
self.kr: {1: 1e-05, 2: 1e-05, 3: 1e-05, 'o': 1e-05}
self.kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
self.update_method: {'rW_niters': 30}
update_method_name: rW_niters
update_method_number: 30
classif_method: c2


Diagnostics on
Epoch: 0
Jr: 57.31953485980409, Jc: 15.608085084497933, Accuracy: 0.0047169811320754715
balance term 0: 3.6724258324766743
Jr: 15.608085084497933, Jc: 15.608085084497933, Accuracy: 0.0047169811320754715
Training...
Epoch 1
eval 1
Jr: 14.526991265654747, Jc: 15.466629307696381, Accuracy: 0.0047169811320754715
Epoch time: 0:01:08.670333.
Est. time remaining: 0:10:18.032997.
Est. tot time: 0:11:26.703330.
Epoch 2
eval 2
Jr: 14.097544524167837, Jc: 15.420143400530629, Accuracy: 0.0047169811320754715
Epoch time: 0:01:07.859872.
Est. time remaining: 0:09:02.878976.
Epoch 3
eval 3
Jr: 13.687627232573405, Jc: 15.373400446463805, Accuracy: 0.0047169811320754715
Epoch time: 0:01:07.813943.
Est. time remaining: 0:07:54.697601.
Epoch 4
eval 4
Jr: 13.296123589556908, Jc: 15.327505355951304, Accuracy: 0.0047169811320754715
Epoch time: 0:01:07.835768.
Est. time remaining: 0:06:47.014608.
Epoch 5
eval 5
Jr: 12.92199768933414, Jc: 15.282789730618187, Accuracy: 0.0047169811320754715
Epoch time: 0:01:07.715968.
Est. time remaining: 0:05:38.579840.
Epoch 6
eval 6
Jr: 12.564277534112438, Jc: 15.238428285193688, Accuracy: 0.0047169811320754715
Epoch time: 0:01:07.897216.
Est. time remaining: 0:04:31.588864.
Epoch 7
eval 7
Jr: 12.222053782307865, Jc: 15.194580923518446, Accuracy: 0.0047169811320754715
Epoch time: 0:01:07.541077.
Est. time remaining: 0:03:22.623231.
Epoch 8
eval 8
Jr: 11.894480115881214, Jc: 15.151468470838907, Accuracy: 0.0047169811320754715
Epoch time: 0:01:07.383908.
Est. time remaining: 0:02:14.767816.
Epoch 9
eval 9
Jr: 11.580762905992325, Jc: 15.108849368338637, Accuracy: 0.0047169811320754715
Epoch time: 0:01:06.996006.
Est. time remaining: 0:01:06.996006.
Epoch 10
eval 10
Jr: 11.280155445604302, Jc: 15.066551020738848, Accuracy: 0.0047169811320754715
Epoch time: 0:01:07.276678.
Est. time remaining: 0:00:00.
Training complete.
Tot time: 0:11:16.996529.
Saving final model...



Final diagnostics over 10 epochs:
Ep. 0 Jr: 15.608085084497933, Jc: 15.608085084497933, Accuracy: 0.0047169811320754715
Ep. 10 Jr: 11.280155445604302, Jc: 15.066551020738848, Accuracy: 0.0047169811320754715
Percent diff Jr: 27.72876759361187, Jc: 3.469574011336863, Accuracy: 0.0
Change per epoch Jr: 2.772876759361187, Jc: 0.34695740113368634, Accuracy: 0.0
Change per min Jr: 2.457510466226795, Jc: 0.307497057610781, Accuracy: 0.0
