exp_name: Experiment_2024_09_10
train_with: True
evaluate_with: False
predict_with: False
notes:  212 train - cost and updates normalized by num terms, and balance factor added
model_type: static
tiled: True
num_tiles: 16
flat_input: True
num_layers: 3
input_shape: (16, 864)
hidden_lyr_sizes: [32, 128]
output_lyr_size: 212
classif_method: c2
activ_func: linear
priors: kurtotic
update_method: {'r_niters_W': 100}
cost_norm: num_terms
num_imgs: 212
num_classes: 212
dataset_train: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
batch_size: 1
epoch_n: 10
kr: {1: 1e-05, 2: 1e-05, 3: 1e-05, 'o': 1e-05}
kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
kV: {1: 0.05, 2: 0.05, 3: 0.05}
alph: {1: 1.0, 2: 0.05, 3: 0.05}
lam: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
ssq: {1: 2, 2: 2, 3: 2, 'o': 2}
save_checkpoint: {'save_every': 50}
load_checkpoint: None
online_diagnostics: True
plot_train: True
dataset_eval: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_eval: first
dataset_pred: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_pred: first



priors: kurtotic init preview:
r0 shape: (16, 864)
r0 first 3: [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
r1 shape: (32,)
r1 first 3: [0.4761529  0.22090758 0.81396869]
U1 shape: (16, 864, 32)
U1 first 3x3x3: [[[ 0.58652337 -0.05493403  0.37117292]
  [-0.36187065  0.16991798 -0.15594676]
  [-0.22322727  0.78819529  1.02461779]]

 [[ 0.51108155  0.20875713  0.07515912]
  [ 0.23689719  0.21458472 -0.74806376]
  [ 0.12871403  0.13393326 -0.16093047]]

 [[-0.59501125 -0.22520615  0.01035063]
  [ 0.98511422 -0.55514452 -0.59597612]
  [ 0.07748553  0.17214869 -0.13934844]]]
r2 shape: (128,)
r2 first 3: [-0.23661122 -0.1367091   0.04825066]
U2 shape: (32, 128)
U2 first 3x3: [[ 0.01359716 -0.62449179 -0.33682582]
 [-0.17216288  0.03760139 -0.10871478]
 [ 0.39832441 -0.60030115 -0.8677279 ]]
r3 shape: (212,)
r3 first 3: [ 0.42293062 -0.35302948  1.30805047]
U3 shape: (128, 212)
U3 first 3x3: [[-0.00379535  0.7647618  -0.56466689]
 [-1.37040881  0.21284525  0.43829076]
 [ 0.65059888 -0.7285964   0.35060639]]
Uo shape: (212, 212)
Uo first 3x3: [[-0.25556608  0.22540356  0.45745079]
 [-0.81557202  0.43456967  0.44905746]
 [ 0.1347846  -0.22130951 -1.04714626]]
einsum arg U1: ij,k->ijk
test: reshaping X into num imgs, num tiles per image, flattened tile
Train init:
X shape (incl. test reshape): (212, 16, 864)
Y shape: (212, 212)
self.all_lyr_sizes: {1: 32, 2: 128, 3: 212}
self.U_sizes: {1: 442368, 2: 4096, 3: 27136, 'o': 44944}
self.r_size_divisors: {0: 13824, 1: 32, 2: 128, 3: 212}
self.U_size_divisors: {1: 442368, 2: 4096, 3: 27136, 'o': 44944}
self.Jr_term_divisors: {1: 4, 2: 4, 3: 3}
self.Jc_term_divisor: 2
self.r_term_divisors: {1: 3, 2: 3, 3: 3}
self.U_term_divisors: {1: 2, 2: 2, 3: 2, 'o': 2}
self.kr: {1: 1e-05, 2: 1e-05, 3: 1e-05, 'o': 1e-05}
self.kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
self.update_method: {'r_niters_W': 100}
update_method_name: r_niters_W
update_method_number: 100
classif_method: c2


Diagnostics on
Epoch: 0
Jr: 72.09467472352945, Jc: 11.638036407271962, Accuracy: 0.0047169811320754715
balance term 0: 6.194745591144697
Jr: 11.638036407271962, Jc: 11.638036407271962, Accuracy: 0.0047169811320754715
Training...
Epoch 1
eval 1
Jr: 9.053117849743904, Jc: 11.48842656510912, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.827377.
Est. time remaining: 0:04:10.446393.
Est. tot time: 0:04:38.273770.
Epoch 2
eval 2
Jr: 8.634747518784804, Jc: 11.458704655388907, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.541355.
Est. time remaining: 0:03:40.330840.
Epoch 3
eval 3
Jr: 8.245916008368747, Jc: 11.429178864146758, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.462086.
Est. time remaining: 0:03:12.234602.
Epoch 4
eval 4
Jr: 7.884096919505377, Jc: 11.400301754688748, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.403632.
Est. time remaining: 0:02:44.421792.
Epoch 5
eval 5
Jr: 7.547000191048875, Jc: 11.37194734577589, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.509034.
Est. time remaining: 0:02:17.545170.
Epoch 6
eval 6
Jr: 7.232556387983474, Jc: 11.343524563861118, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.366442.
Est. time remaining: 0:01:49.465768.
Epoch 7
eval 7
Jr: 6.938895937042675, Jc: 11.31514412394826, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.300079.
Est. time remaining: 0:01:21.900237.
Epoch 8
eval 8
Jr: 6.664312024128547, Jc: 11.287172027678194, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.474467.
Est. time remaining: 0:00:54.948934.
Epoch 9
eval 9
Jr: 6.407266483381224, Jc: 11.260117287402027, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.355367.
Est. time remaining: 0:00:27.355367.
Epoch 10
eval 10
Jr: 6.166356893116052, Jc: 11.232048608485321, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.297638.
Est. time remaining: 0:00:00.
Training complete.
Tot time: 0:04:34.543211.
Saving final model...



Final diagnostics over 10 epochs:
Ep. 0 Jr: 11.638036407271962, Jc: 11.638036407271962, Accuracy: 0.0047169811320754715
Ep. 10 Jr: 6.166356893116052, Jc: 11.232048608485321, Accuracy: 0.0047169811320754715
Percent diff Jr: 47.015487172191364, Jc: 3.4884561671671768, Accuracy: 0.0
Change per epoch Jr: 4.701548717219136, Jc: 0.34884561671671765, Accuracy: 0.0
Change per min Jr: 10.274991758333742, Jc: 0.7623840679492548, Accuracy: 0.0
