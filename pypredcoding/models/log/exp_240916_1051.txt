exp_name: Experiment_2024_09_16expandedr1
train_with: True
evaluate_with: False
predict_with: False
notes:  212 train - scaled, long runs
model_type: static
tiled: True
num_tiles: 16
flat_input: True
num_layers: 3
input_shape: (16, 864)
hidden_lyr_sizes: [512, 128]
output_lyr_size: 212
classif_method: c2
activ_func: linear
priors: kurtotic
update_method: {'r_niters_W': 100}
cost_norm: num_terms
num_imgs: 212
num_classes: 212
dataset_train: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
batch_size: 1
epoch_n: 10
kr: {1: 0.0001, 2: 0.0001, 3: 0.0001, 'o': 0.0001}
kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
kV: {1: 0.05, 2: 0.05, 3: 0.05}
alph: {1: 1.0, 2: 0.05, 3: 0.05}
lam: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
ssq: {1: 2, 2: 2, 3: 2, 'o': 2}
save_checkpoint: {'save_every': 50}
load_checkpoint: None
online_diagnostics: True
plot_train: True
dataset_eval: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_eval: first
dataset_pred: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_pred: first



priors: kurtotic init preview:
r0 shape: (16, 864)
r0 first 3: [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
r1 shape: (512,)
r1 first 3: [ 0.28024754  0.02344021 -1.15773321]
U1 shape: (16, 864, 512)
U1 first 3x3x3: [[[ 0.98826015  0.65294169 -0.21886237]
  [ 0.0560148  -0.20770705 -1.39609578]
  [ 0.27443661  2.10043788  0.05755081]]

 [[ 0.93975284 -0.14738383  1.43777424]
  [-1.59832085  0.30975063 -0.07052338]
  [ 0.48852625 -0.45860795  0.71354927]]

 [[ 0.10723474 -0.53234445  0.28084877]
  [ 0.76749134  0.4032589  -0.10814601]
  [ 0.56799411 -0.6416921  -0.45063847]]]
r2 shape: (128,)
r2 first 3: [-0.43880757 -0.19660505 -0.62823534]
U2 shape: (512, 128)
U2 first 3x3: [[-0.10700897  0.3638916  -0.11439638]
 [ 0.84332843 -0.30972327  0.42439211]
 [-1.37391445 -0.20155758  0.35658482]]
r3 shape: (212,)
r3 first 3: [-0.00728308  0.13758844  0.07380992]
U3 shape: (128, 212)
U3 first 3x3: [[-0.23380366  1.15777714 -0.17558035]
 [-0.24143377  0.55855368  0.46012848]
 [ 0.17826353 -0.06890675 -0.03662087]]
Uo shape: (212, 212)
Uo first 3x3: [[ 1.0214642   0.09508686  0.56557381]
 [-0.82664773  0.64212128  0.49010089]
 [-0.30759038  0.26399261 -0.50280212]]
einsum arg U1: ij,k->ijk
test: reshaping X into num imgs, num tiles per image, flattened tile
Train init:
X shape (incl. test reshape): (212, 16, 864)
Y shape: (212, 212)
self.all_lyr_sizes: {1: 512, 2: 128, 3: 212}
self.U_sizes: {1: 7077888, 2: 65536, 3: 27136, 'o': 44944}
self.r_size_divisors: {0: 13824, 1: 512, 2: 128, 3: 212}
self.U_size_divisors: {1: 7077888, 2: 65536, 3: 27136, 'o': 44944}
self.Jr_term_divisors: {1: 4, 2: 4, 3: 3}
self.Jc_term_divisor: 2
self.r_term_divisors: {1: 3, 2: 3, 3: 3}
self.U_term_divisors: {1: 2, 2: 2, 3: 2, 'o': 2}
self.kr: {1: 0.0001, 2: 0.0001, 3: 0.0001, 'o': 0.0001}
self.kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
self.update_method: {'r_niters_W': 100}
update_method_name: r_niters_W
update_method_number: 100
classif_method: c2


Diagnostics on
Epoch: 0
Jr: 16.2902082576802, Jc: 8.54968295958645, Accuracy: 0.0047169811320754715
balance term 0: 1.90535816762826
Jr: 8.54968295958645, Jc: 8.54968295958645, Accuracy: 0.0047169811320754715
Training...
Epoch 1
eval 1
Jr: 3.656086082612231, Jc: 6.9213228580200274, Accuracy: 0.0047169811320754715
Epoch time: 0:07:09.436804.
Est. time remaining: 1:04:24.931236.
Est. tot time: 1:11:34.368040.
Epoch 2
eval 2
Jr: 2.60346515895565, Jc: 6.541071996743037, Accuracy: 0.0047169811320754715
Epoch time: 0:07:02.477414.
Est. time remaining: 0:56:19.819312.
Epoch 3
eval 3
Jr: 1.9355569025131059, Jc: 6.353236214339668, Accuracy: 0.0047169811320754715
Epoch time: 0:06:45.886133.
Est. time remaining: 0:47:21.202931.
Epoch 4
eval 4
Jr: 1.4761577831024089, Jc: 6.262815695858757, Accuracy: 0.0047169811320754715
Epoch time: 0:07:02.824923.
Est. time remaining: 0:42:16.949538.
Epoch 5
eval 5
Jr: 1.1485368039435406, Jc: 6.211221500134189, Accuracy: 0.0047169811320754715
Epoch time: 0:07:05.723259.
Est. time remaining: 0:35:28.616295.
Epoch 6
eval 6
Jr: 0.9105633259213662, Jc: 6.175606702781126, Accuracy: 0.0047169811320754715
Epoch time: 0:07:00.628368.
Est. time remaining: 0:28:02.513472.
Epoch 7
eval 7
Jr: 0.7357913520959463, Jc: 6.152700431229434, Accuracy: 0.0047169811320754715
Epoch time: 0:07:00.351680.
Est. time remaining: 0:21:01.055040.
Epoch 8
eval 8
Jr: 0.6062372734792132, Jc: 6.133907923176001, Accuracy: 0.0047169811320754715
Epoch time: 0:07:03.641287.
Est. time remaining: 0:14:07.282574.
Epoch 9
eval 9
Jr: 0.5093056669605459, Jc: 6.120750813810006, Accuracy: 0.0047169811320754715
Epoch time: 0:07:02.870591.
Est. time remaining: 0:07:02.870591.
Epoch 10
eval 10
