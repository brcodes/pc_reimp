exp_name: Experiment_2024_09_10
train_with: True
evaluate_with: False
predict_with: False
notes:  212 train - cost and updates normalized by num terms, and balance factor added
model_type: static
tiled: True
num_tiles: 16
flat_input: True
num_layers: 3
input_shape: (16, 864)
hidden_lyr_sizes: [32, 128]
output_lyr_size: 212
classif_method: c2
activ_func: linear
priors: kurtotic
update_method: {'r_niters_W': 100}
cost_norm: num_terms
num_imgs: 212
num_classes: 212
dataset_train: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
batch_size: 1
epoch_n: 10
kr: {1: 0.0001, 2: 0.0001, 3: 0.0001, 'o': 0.0001}
kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
kV: {1: 0.05, 2: 0.05, 3: 0.05}
alph: {1: 1.0, 2: 0.05, 3: 0.05}
lam: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
ssq: {1: 2, 2: 2, 3: 2, 'o': 2}
save_checkpoint: {'save_every': 50}
load_checkpoint: None
online_diagnostics: True
plot_train: True
dataset_eval: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_eval: first
dataset_pred: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_pred: first



priors: kurtotic init preview:
r0 shape: (16, 864)
r0 first 3: [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
r1 shape: (32,)
r1 first 3: [-0.08045184 -0.86030461 -0.71591232]
U1 shape: (16, 864, 32)
U1 first 3x3x3: [[[-0.3319271   0.28257068  0.1812588 ]
  [-0.06341804 -0.22504256 -1.07667529]
  [-0.03959541 -1.49412348  0.36831526]]

 [[ 0.68232363  0.10769096 -0.68198433]
  [ 0.76603546  1.00977587 -0.26654891]
  [-0.00949767 -0.69304891 -0.16795052]]

 [[ 0.2199158  -0.28192653  0.29387805]
  [-1.64985645 -1.32335154  0.20419828]
  [-0.68436738 -0.87839506  0.55901924]]]
r2 shape: (128,)
r2 first 3: [-0.40979634 -0.44145616 -1.6068032 ]
U2 shape: (32, 128)
U2 first 3x3: [[ 1.31056929  0.55846677  0.06469425]
 [-0.02240277  0.57214849 -3.07828598]
 [-0.89797595 -0.03867931  0.44068517]]
r3 shape: (212,)
r3 first 3: [ 1.42410587 -0.41596681 -0.42798799]
U3 shape: (128, 212)
U3 first 3x3: [[-0.14901811  0.02718486  0.21768689]
 [ 0.30770142  0.33759911  0.11094883]
 [-1.40381636 -0.13066919 -0.76964453]]
Uo shape: (212, 212)
Uo first 3x3: [[ 0.04860119  0.63509814 -0.1084034 ]
 [ 1.09268367 -0.33229126  0.32580708]
 [ 0.18972213 -0.170635   -0.51445622]]
einsum arg U1: ij,k->ijk
test: reshaping X into num imgs, num tiles per image, flattened tile
Train init:
X shape (incl. test reshape): (212, 16, 864)
Y shape: (212, 212)
self.all_lyr_sizes: {1: 32, 2: 128, 3: 212}
self.U_sizes: {1: 442368, 2: 4096, 3: 27136, 'o': 44944}
self.r_size_divisors: {0: 13824, 1: 32, 2: 128, 3: 212}
self.U_size_divisors: {1: 442368, 2: 4096, 3: 27136, 'o': 44944}
self.Jr_term_divisors: {1: 4, 2: 4, 3: 3}
self.Jc_term_divisor: 2
self.r_term_divisors: {1: 3, 2: 3, 3: 3}
self.U_term_divisors: {1: 2, 2: 2, 3: 2, 'o': 2}
self.kr: {1: 0.0001, 2: 0.0001, 3: 0.0001, 'o': 0.0001}
self.kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
self.update_method: {'r_niters_W': 100}
update_method_name: r_niters_W
update_method_number: 100
classif_method: c2


Diagnostics on
Epoch: 0
Jr: 23.48019105494002, Jc: 9.744676154291161, Accuracy: 0.0047169811320754715
balance term 0: 2.4095404180877056
Jr: 9.744676154291161, Jc: 9.744676154291161, Accuracy: 0.0047169811320754715
Training...
Epoch 1
eval 1
Jr: 2.8026197759263454, Jc: 8.12920712699042, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.158177.
Est. time remaining: 0:04:04.423593.
Est. tot time: 0:04:31.581770.
Epoch 2
eval 2
Jr: 2.046728734731156, Jc: 7.790718645936653, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.491350.
Est. time remaining: 0:03:39.930800.
Epoch 3
eval 3
Jr: 1.5797369570518225, Jc: 7.584100608097609, Accuracy: 0.0047169811320754715
Epoch time: 0:00:26.866147.
Est. time remaining: 0:03:08.063029.
Epoch 4
eval 4
Jr: 1.2605047994513494, Jc: 7.463886651957781, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.072173.
Est. time remaining: 0:02:42.433038.
Epoch 5
eval 5
Jr: 1.0291132415624271, Jc: 7.3936308771178965, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.074969.
Est. time remaining: 0:02:15.374845.
Epoch 6
eval 6
Jr: 0.8554762427265207, Jc: 7.362828565832662, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.015220.
Est. time remaining: 0:01:48.060880.
Epoch 7
eval 7
Jr: 0.722331160648924, Jc: 7.353194519105572, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.283451.
Est. time remaining: 0:01:21.850353.
Epoch 8
eval 8
Jr: 0.6189771095309247, Jc: 7.357016708783386, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.148118.
Est. time remaining: 0:00:54.296236.
Epoch 9
eval 9
Jr: 0.5381757226874716, Jc: 7.368038514627665, Accuracy: 0.0047169811320754715
Epoch time: 0:00:27.113469.
Est. time remaining: 0:00:27.113469.
Epoch 10
eval 10
Jr: 0.47461225393855094, Jc: 7.38549674877833, Accuracy: 0.0047169811320754715
Epoch time: 0:00:26.983768.
Est. time remaining: 0:00:00.
Training complete.
Tot time: 0:04:31.212641.
Saving final model...



Final diagnostics over 10 epochs:
Ep. 0 Jr: 9.744676154291161, Jc: 9.744676154291161, Accuracy: 0.0047169811320754715
Ep. 10 Jr: 0.47461225393855094, Jc: 7.38549674877833, Accuracy: 0.0047169811320754715
Percent diff Jr: 95.12952255750899, Jc: 24.209931332340318, Accuracy: 0.0
Change per epoch Jr: 9.5129522557509, Jc: 2.420993133234032, Accuracy: 0.0
Change per min Jr: 21.04537359470106, Jc: 5.355929851147384, Accuracy: 0.0
