exp_name: Experiment_2024_09_10
train_with: True
evaluate_with: False
predict_with: False
notes:  212 train - cost and updates normalized by num terms, and balance factor added
model_type: static
tiled: True
num_tiles: 16
flat_input: True
num_layers: 3
input_shape: (16, 864)
hidden_lyr_sizes: [32, 128]
output_lyr_size: 212
classif_method: c2
activ_func: linear
priors: kurtotic
update_method: {'r_eq_W': 0.05}
cost_norm: num_terms
num_imgs: 212
num_classes: 212
dataset_train: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
batch_size: 1
epoch_n: 10
kr: {1: 1e-05, 2: 1e-05, 3: 1e-05, 'o': 1e-05}
kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
kV: {1: 0.05, 2: 0.05, 3: 0.05}
alph: {1: 1.0, 2: 0.05, 3: 0.05}
lam: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
ssq: {1: 2, 2: 2, 3: 2, 'o': 2}
save_checkpoint: {'save_every': 50}
load_checkpoint: None
online_diagnostics: True
plot_train: True
dataset_eval: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_eval: first
dataset_pred: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_pred: first



priors: kurtotic init preview:
r0 shape: (16, 864)
r0 first 3: [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
r1 shape: (32,)
r1 first 3: [0.92897751 0.69886106 0.73297843]
U1 shape: (16, 864, 32)
U1 first 3x3x3: [[[ 0.3938879  -0.88936801  0.92355299]
  [ 0.03186764 -0.26404694 -0.41160367]
  [ 0.04189716  0.00991358 -0.53033106]]

 [[ 0.73832469 -0.03757109  0.37263035]
  [-2.03457634  0.06031508 -0.22926507]
  [-0.54180759 -1.02593242 -0.04466928]]

 [[-0.91162937  0.31481824  1.00989401]
  [ 0.41781033  0.1510891  -0.30310616]
  [-0.33536315  0.17388455 -0.03677711]]]
r2 shape: (128,)
r2 first 3: [ 0.88328748  1.03523257 -0.22497679]
U2 shape: (32, 128)
U2 first 3x3: [[ 0.38292906  1.56452604 -0.26330184]
 [-0.58425867  0.20094742  0.23430552]
 [-0.41629601  0.23732633  1.28725965]]
r3 shape: (212,)
r3 first 3: [ 0.00211856  0.04495746 -1.34947563]
U3 shape: (128, 212)
U3 first 3x3: [[-0.2807948   0.32768055  0.57714002]
 [-0.05045519  0.36477676 -1.23711058]
 [ 0.28843607 -0.02316401  0.45858747]]
Uo shape: (212, 212)
Uo first 3x3: [[ 0.51802849 -1.90568219  0.20937193]
 [ 0.56965334 -0.68227669 -0.25348214]
 [ 1.50297398  0.59751674 -0.20150246]]
einsum arg U1: ij,k->ijk
test: reshaping X into num imgs, num tiles per image, flattened tile
Train init:
X shape (incl. test reshape): (212, 16, 864)
Y shape: (212, 212)
self.all_lyr_sizes: {1: 32, 2: 128, 3: 212}
self.U_sizes: {1: 442368, 2: 4096, 3: 27136, 'o': 44944}
self.r_size_divisors: {0: 13824, 1: 32, 2: 128, 3: 212}
self.U_size_divisors: {1: 442368, 2: 4096, 3: 27136, 'o': 44944}
self.Jr_term_divisors: {1: 4, 2: 4, 3: 3}
self.Jc_term_divisor: 2
self.r_term_divisors: {1: 3, 2: 3, 3: 3}
self.U_term_divisors: {1: 2, 2: 2, 3: 2, 'o': 2}
self.kr: {1: 1e-05, 2: 1e-05, 3: 1e-05, 'o': 1e-05}
self.kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
self.update_method: {'r_eq_W': 0.05}
update_method_name: r_eq_W
update_method_number: 0.05
classif_method: c2


Diagnostics on
Epoch: 0
Jr: 43.79335027576895, Jc: 12.752715873840138, Accuracy: 0.0047169811320754715
balance term 0: 3.434041086542435
Jr: 12.752715873840138, Jc: 12.752715873840138, Accuracy: 0.0047169811320754715
Training...
Epoch 1
eval 1
Jr: 12.722496254737692, Jc: 12.749920589026425, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.764261.
Est. time remaining: 0:00:33.878349.
Est. tot time: 0:00:37.642610.
Epoch 2
eval 2
Jr: 12.708578252718532, Jc: 12.748909630584778, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.688415.
Est. time remaining: 0:00:29.507320.
Epoch 3
eval 3
Jr: 12.694681921374125, Jc: 12.74789072208484, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.688115.
Est. time remaining: 0:00:25.816805.
Epoch 4
eval 4
Jr: 12.680807212229885, Jc: 12.746882914695785, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.681120.
Est. time remaining: 0:00:22.086720.
Epoch 5
eval 5
Jr: 12.666954051360346, Jc: 12.745836970810137, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.735942.
Est. time remaining: 0:00:18.679710.
Epoch 6
eval 6
Jr: 12.653122358983078, Jc: 12.744835303560253, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.701485.
Est. time remaining: 0:00:14.805940.
Epoch 7
eval 7
Jr: 12.639312058747251, Jc: 12.743812710671705, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.701803.
Est. time remaining: 0:00:11.105409.
Epoch 8
eval 8
Jr: 12.625523337973066, Jc: 12.742796229887423, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.704056.
Est. time remaining: 0:00:07.408112.
Epoch 9
eval 9
Jr: 12.611755910854093, Jc: 12.741771717638787, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.660920.
Est. time remaining: 0:00:03.660920.
Epoch 10
eval 10
Jr: 12.598009831113739, Jc: 12.74075200360849, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.671379.
Est. time remaining: 0:00:00.
Training complete.
Tot time: 0:00:37.003182.
Saving final model...



Final diagnostics over 10 epochs:
Ep. 0 Jr: 12.752715873840138, Jc: 12.752715873840138, Accuracy: 0.0047169811320754715
Ep. 10 Jr: 12.598009831113739, Jc: 12.74075200360849, Accuracy: 0.0047169811320754715
Percent diff Jr: 1.2131223204286268, Jc: 0.09381429297103634, Accuracy: 0.0
Change per epoch Jr: 0.12131223204286268, Jc: 0.009381429297103634, Accuracy: 0.0
Change per min Jr: 1.9670562176441369, Jc: 0.15211820373345677, Accuracy: 0.0
