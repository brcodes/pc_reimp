exp_name: Experiment_2024_09_10
train_with: True
evaluate_with: False
predict_with: False
notes:  212 train - cost and updates normalized by num terms, and balance factor added
model_type: static
tiled: True
num_tiles: 16
flat_input: True
num_layers: 3
input_shape: (16, 864)
hidden_lyr_sizes: [32, 128]
output_lyr_size: 212
classif_method: c1
activ_func: linear
priors: kurtotic
update_method: {'rW_niters': 30}
cost_norm: num_terms
num_imgs: 212
num_classes: 212
dataset_train: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
batch_size: 1
epoch_n: 10
kr: {1: 0.0001, 2: 0.0001, 3: 0.0001, 'o': 0.0001}
kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
kV: {1: 0.05, 2: 0.05, 3: 0.05}
alph: {1: 1.0, 2: 0.05, 3: 0.05}
lam: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
ssq: {1: 2, 2: 2, 3: 2, 'o': 2}
save_checkpoint: {'save_every': 50}
load_checkpoint: None
online_diagnostics: True
plot_train: True
dataset_eval: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_eval: first
dataset_pred: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_pred: first



priors: kurtotic init preview:
r0 shape: (16, 864)
r0 first 3: [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
r1 shape: (32,)
r1 first 3: [ 0.02679235  0.42425373 -0.20525403]
U1 shape: (16, 864, 32)
U1 first 3x3x3: [[[-0.03536655  0.52159329 -0.38710466]
  [-0.0920018  -0.84906321  0.14765399]
  [-0.36056909 -0.22113001 -0.14318679]]

 [[ 0.14432039 -0.64142867 -0.82518295]
  [ 0.976959   -2.59799821  0.71190288]
  [-0.24971168 -0.93062668  0.81982412]]

 [[ 0.78642797  0.67975845 -0.23786945]
  [ 0.04198925 -0.1312213  -0.88798096]
  [-0.57337009 -0.1017615   0.04032614]]]
r2 shape: (128,)
r2 first 3: [-0.80459486  0.73861906  1.00859805]
U2 shape: (32, 128)
U2 first 3x3: [[-0.03456599  1.05931155 -1.13377053]
 [ 1.07487037 -0.17915588 -0.14829286]
 [ 1.22729062 -0.71901524  0.06656218]]
r3 shape: (212,)
r3 first 3: [-0.2530727  -0.21209468  0.35705616]
U3 shape: (128, 212)
U3 first 3x3: [[ 1.685825    0.18368072 -0.10785222]
 [ 0.1951317  -0.45314266 -0.72675066]
 [ 0.12887832 -0.63749607  0.24438075]]
einsum arg U1: ij,k->ijk
test: reshaping X into num imgs, num tiles per image, flattened tile
Train init:
X shape (incl. test reshape): (212, 16, 864)
Y shape: (212, 212)
self.all_lyr_sizes: {1: 32, 2: 128, 3: 212}
self.U_sizes: {1: 442368, 2: 4096, 3: 27136}
self.r_size_divisors: {0: 13824, 1: 32, 2: 128, 3: 212}
self.U_size_divisors: {1: 442368, 2: 4096, 3: 27136}
self.Jr_term_divisors: {1: 4, 2: 4, 3: 3}
self.Jc_term_divisor: 1
self.r_term_divisors: {1: 3, 2: 3, 3: 3}
self.U_term_divisors: {1: 2, 2: 2, 3: 2}
self.kr: {1: 0.0001, 2: 0.0001, 3: 0.0001, 'o': 0.0001}
self.kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
self.update_method: {'rW_niters': 30}
update_method_name: rW_niters
update_method_number: 30
classif_method: c1


Diagnostics on
Epoch: 0
Jr: 52.84901669319963, Jc: 5.61807917713716, Accuracy: 0.0047169811320754715
balance term 0: 9.406954766367361
Jr: 5.61807917713716, Jc: 5.61807917713716, Accuracy: 0.0047169811320754715
Training...
Epoch 1
eval 1
Jr: 3.1313785309635183, Jc: 5.57251920517993, Accuracy: 0.0047169811320754715
Epoch time: 0:01:00.817150.
Est. time remaining: 0:09:07.354350.
Est. tot time: 0:10:08.171500.
Epoch 2
eval 2
Jr: 2.92548717892865, Jc: 5.567755713218354, Accuracy: 0.0047169811320754715
Epoch time: 0:00:59.860701.
Est. time remaining: 0:07:58.885608.
Epoch 3
eval 3
Jr: 2.7414005800474155, Jc: 5.563421052091677, Accuracy: 0.0047169811320754715
Epoch time: 0:00:59.535464.
Est. time remaining: 0:06:56.748248.
Epoch 4
eval 4
Jr: 2.5762410886771687, Jc: 5.5594658595816195, Accuracy: 0.0047169811320754715
Epoch time: 0:00:59.539042.
Est. time remaining: 0:05:57.234252.
Epoch 5
eval 5
Jr: 2.4275592328993993, Jc: 5.5555527363866375, Accuracy: 0.0047169811320754715
Epoch time: 0:00:59.124840.
Est. time remaining: 0:04:55.624200.
Epoch 6
eval 6
Jr: 2.293263941601225, Jc: 5.551592423573477, Accuracy: 0.0047169811320754715
Epoch time: 0:00:59.051188.
Est. time remaining: 0:03:56.204752.
Epoch 7
eval 7
Jr: 2.171572184900027, Jc: 5.548371029198583, Accuracy: 0.0047169811320754715
Epoch time: 0:00:59.832065.
Est. time remaining: 0:02:59.496195.
Epoch 8
eval 8
Jr: 2.0609480387052206, Jc: 5.545079360698314, Accuracy: 0.0047169811320754715
Epoch time: 0:00:59.196216.
Est. time remaining: 0:01:58.392432.
Epoch 9
eval 9
Jr: 1.9600781109081211, Jc: 5.542043612244388, Accuracy: 0.0047169811320754715
Epoch time: 0:00:59.326915.
Est. time remaining: 0:00:59.326915.
Epoch 10
eval 10
Jr: 1.8678260954190622, Jc: 5.539010128610571, Accuracy: 0.0047169811320754715
Epoch time: 0:00:59.181577.
Est. time remaining: 0:00:00.
Training complete.
Tot time: 0:09:55.470634.
Saving final model...



Final diagnostics over 10 epochs:
Ep. 0 Jr: 5.61807917713716, Jc: 5.61807917713716, Accuracy: 0.0047169811320754715
Ep. 10 Jr: 1.8678260954190622, Jc: 5.539010128610571, Accuracy: 0.0047169811320754715
Percent diff Jr: 66.75329705177168, Jc: 1.4074035988734552, Accuracy: 0.0
Change per epoch Jr: 6.675329705177168, Jc: 0.1407403598873455, Accuracy: 0.0
Change per min Jr: 6.726104688323389, Jc: 0.14181088220113186, Accuracy: 0.0
