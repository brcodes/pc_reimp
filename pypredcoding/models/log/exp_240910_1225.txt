exp_name: Experiment_2024_09_10
train_with: True
evaluate_with: False
predict_with: False
notes:  212 train - cost and updates normalized by num terms, and balance factor added
model_type: static
tiled: True
num_tiles: 16
flat_input: True
num_layers: 3
input_shape: (16, 864)
hidden_lyr_sizes: [32, 128]
output_lyr_size: 212
classif_method: c2
activ_func: linear
priors: kurtotic
update_method: {'r_eq_W': 0.05}
cost_norm: num_terms
num_imgs: 212
num_classes: 212
dataset_train: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
batch_size: 1
epoch_n: 10
kr: {1: 0.0001, 2: 0.0001, 3: 0.0001, 'o': 0.0001}
kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
kV: {1: 0.05, 2: 0.05, 3: 0.05}
alph: {1: 1.0, 2: 0.05, 3: 0.05}
lam: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
ssq: {1: 2, 2: 2, 3: 2, 'o': 2}
save_checkpoint: {'save_every': 50}
load_checkpoint: None
online_diagnostics: True
plot_train: True
dataset_eval: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_eval: first
dataset_pred: ds.trace212_212_li_trace212_132_84_tl_16_36_24_32_20.pydb
plot_pred: first



priors: kurtotic init preview:
r0 shape: (16, 864)
r0 first 3: [[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
r1 shape: (32,)
r1 first 3: [-0.65754824 -0.16523286 -0.19760337]
U1 shape: (16, 864, 32)
U1 first 3x3x3: [[[-5.91425944e-01 -2.86218458e-01  1.21783273e-01]
  [-2.40405212e-01 -8.18694749e-01  1.06169840e-01]
  [ 6.36040870e-01 -8.14716461e-02  7.23863004e-01]]

 [[ 7.73530829e-02  2.54553658e-01  7.96923982e-02]
  [ 5.31718647e-01 -3.78584390e-02 -1.05345210e+00]
  [-8.37750269e-02  1.01991648e+00 -4.08107231e-01]]

 [[ 7.68332491e-01 -2.15236618e-02  1.31407020e-01]
  [-1.49536226e-04 -3.90227342e-01 -8.87007757e-01]
  [ 1.50485666e+00  1.21598351e-02  1.62885854e+00]]]
r2 shape: (128,)
r2 first 3: [0.10575249 0.48437751 0.78311651]
U2 shape: (32, 128)
U2 first 3x3: [[-0.47084977  0.18525447 -0.16645669]
 [ 0.21871224  0.85935432  0.21465106]
 [-0.7060803   0.13335511  0.14849472]]
r3 shape: (212,)
r3 first 3: [ 0.61779945 -0.45527454  0.3578696 ]
U3 shape: (128, 212)
U3 first 3x3: [[-0.04035995 -0.53410198 -0.22078709]
 [ 1.68582128 -0.10680166 -1.79305644]
 [-0.11748627  0.90976522 -0.01337317]]
Uo shape: (212, 212)
Uo first 3x3: [[ 0.03551458  0.27620677  0.7583368 ]
 [ 0.32355564  0.18044869 -0.67028453]
 [-2.02504298  1.33627273 -0.15754079]]
einsum arg U1: ij,k->ijk
test: reshaping X into num imgs, num tiles per image, flattened tile
Train init:
X shape (incl. test reshape): (212, 16, 864)
Y shape: (212, 212)
self.all_lyr_sizes: {1: 32, 2: 128, 3: 212}
self.U_sizes: {1: 442368, 2: 4096, 3: 27136, 'o': 44944}
self.r_size_divisors: {0: 13824, 1: 32, 2: 128, 3: 212}
self.U_size_divisors: {1: 442368, 2: 4096, 3: 27136, 'o': 44944}
self.Jr_term_divisors: {1: 4, 2: 4, 3: 3}
self.Jc_term_divisor: 2
self.r_term_divisors: {1: 3, 2: 3, 3: 3}
self.U_term_divisors: {1: 2, 2: 2, 3: 2, 'o': 2}
self.kr: {1: 0.0001, 2: 0.0001, 3: 0.0001, 'o': 0.0001}
self.kU: {1: 0.001, 2: 0.001, 3: 0.001, 'o': 0.001}
self.update_method: {'r_eq_W': 0.05}
update_method_name: r_eq_W
update_method_number: 0.05
classif_method: c2


Diagnostics on
Epoch: 0
Jr: 53.479794953337795, Jc: 9.177319493563738, Accuracy: 0.0047169811320754715
balance term 0: 5.827387287850705
Jr: 9.177319493563738, Jc: 9.177319493563738, Accuracy: 0.0047169811320754715
Training...
Epoch 1
eval 1
Jr: 8.96765295866176, Jc: 9.174361872412717, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.751723.
Est. time remaining: 0:00:33.765507.
Est. tot time: 0:00:37.517230.
Epoch 2
eval 2
Jr: 8.921116158657899, Jc: 9.17355388666489, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.757698.
Est. time remaining: 0:00:30.061584.
Epoch 3
eval 3
Jr: 8.87492192717326, Jc: 9.172795812282025, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.740672.
Est. time remaining: 0:00:26.184704.
Epoch 4
eval 4
Jr: 8.829067945855291, Jc: 9.172134155540634, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.706923.
Est. time remaining: 0:00:22.241538.
Epoch 5
eval 5
Jr: 8.783550832535116, Jc: 9.171327201785788, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.683509.
Est. time remaining: 0:00:18.417545.
Epoch 6
eval 6
Jr: 8.738368005136003, Jc: 9.170618900529018, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.715698.
Est. time remaining: 0:00:14.862792.
Epoch 7
eval 7
Jr: 8.693516640937098, Jc: 9.169860805370172, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.678490.
Est. time remaining: 0:00:11.035470.
Epoch 8
eval 8
Jr: 8.64899327190334, Jc: 9.16914210691168, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.694598.
Est. time remaining: 0:00:07.389196.
Epoch 9
eval 9
Jr: 8.604795755929818, Jc: 9.168330766231572, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.684390.
Est. time remaining: 0:00:03.684390.
Epoch 10
eval 10
Jr: 8.560921190531968, Jc: 9.167571635666494, Accuracy: 0.0047169811320754715
Epoch time: 0:00:03.767280.
Est. time remaining: 0:00:00.
Training complete.
Tot time: 0:00:37.186675.
Saving final model...



Final diagnostics over 10 epochs:
Ep. 0 Jr: 9.177319493563738, Jc: 9.177319493563738, Accuracy: 0.0047169811320754715
Ep. 10 Jr: 8.560921190531968, Jc: 9.167571635666494, Accuracy: 0.0047169811320754715
Percent diff Jr: 6.716539654787704, Jc: 0.10621683056888512, Accuracy: 0.0
Change per epoch Jr: 0.6716539654787704, Jc: 0.010621683056888511, Accuracy: 0.0
Change per min Jr: 10.837010280893955, Jc: 0.17137885638156966, Accuracy: 0.0
